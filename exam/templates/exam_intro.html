{% extends 'base.html' %}
{% load i18n %}
{% load staticfiles %}

{% block js %}
    <script type="text/javascript" src="{% static "js/jquery.plugin.js" %}"></script>
    <script type="text/javascript" src="{% static "js/jquery.countdown.js" %}"></script>
    <script type="text/javascript" src="{% static "js/jquery.countdown-fa.js" %}"></script>
    <script type="text/javascript">
        $(document).ready(function () {
            {% if exam.number_of_attempts <= attempts %}
                alertBar('متاسفانه شما دیگر قادر به شرکت در این آزمون نیستید');
            {% endif %}
            {%  if exam.start_date > current_date %}
                $.countdown.setDefaults({description: 'تا شروع آزمون'});
                $('#timer').fadeIn('slow');
                $('#timer').countdown({onTick: function (periods) {
                    var secs = $.countdown.periodsToSeconds(periods);
                    if (secs == 0)
                        $('#timer').fadeOut('slow', function () {
                            $('#enter').fadeIn('slow');
                        });

                }, until: new Date({{ exam.start_date.year}}, {{ exam.start_date.month}}-1, {{ exam.start_date.day}})});
                {#            {% else %}#}

            {% endif %}
            $('#enter').fadeIn('slow');


        });
    </script>
{% endblock %}

{% block css %}
    <link href="{% static "css/jquery.countdown.css" %}" rel="stylesheet">
{% endblock %}

{% block content %}

    <h1>آزمون {{ exam.local_name }} </h1>

    <div class="alertbar">
    </div>
    <div class="container">
        <p>
            {{ exam.description | safe }}

        </p>
    </div>
    <div class="container duration">مدت زمان آزمون:
        {{ exam.duration }}
        دقیقه
    </div>
    <div class="container">
        تعداد دفعات شرکت شما در این آزمون:
        {{ attempts }}
        از
        {{ exam.number_of_attempts }}
    </div>
    <br/>

    <div class="container">
        دانش مورد نیاز این آزمون
        <ul>
            {% if exam.required_knowledge.exists %}
                {% for k in exam.required_knowledge.all %}
                    <li>{{ k.name }}</li>
                {% endfor %}
            {% else %}
                <li>دانش خاصی برای این آزمون مشخص نگردیده است
                </li>
            {% endif %}
        </ul>
    </div>


    <div id="timer" class="container form-group timer" style="display: none;"></div>
    <div id="enter" class="container enter" style="display: none;">
        {% if exam.number_of_attempts > attempts %}
            <a class="btn btn-success " href="{% url 'exam:start' exam.id %}">
                ورود به آزمون
            </a>
        {% endif %}

    </div>
{% endblock %}